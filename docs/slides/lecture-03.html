<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>Multiple Linear Regression</title>
    <meta charset="utf-8" />
    <meta name="author" content="Brandon M. Greenwell" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/metropolis.css" rel="stylesheet" />
    <link href="libs/remark-css/metropolis-fonts.css" rel="stylesheet" />
    <link href="libs/remark-css/hygge.css" rel="stylesheet" />
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/plotly-binding/plotly.js"></script>
    <script src="libs/typedarray/typedarray.min.js"></script>
    <script src="libs/jquery/jquery.min.js"></script>
    <link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
    <script src="libs/crosstalk/js/crosstalk.min.js"></script>
    <link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="libs/plotly-main/plotly-latest.min.js"></script>
    <link href="libs/font-awesome-animation/font-awesome-animation-emi.css" rel="stylesheet" />
    <script src="libs/fontawesome/js/fontawesome-all.min.js"></script>
    <link rel="stylesheet" href="custom.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Multiple Linear Regression
## Lecture 03
### Brandon M. Greenwell
### 30 October, 2019

---

class: clear, middle, center



.font300[

[R code for these slides](https://github.com/bgreenwell/uc-bana7052/blob/master/code/lecture-03.R)

]


---
class: clear, middle, center

&lt;img src="images/linear-algebra-tweet.png" width="60%" style="display: block; margin: auto;" /&gt;


---
# Reading assignment

.font200[

* Chapters: 5; 6

    - Sections: 5.9-5.11; 6.1-6.6

* Main topics:

    - Regression in matrix form (5.9-5.11)
   
    - Multiple linear regression (6.1-6.4)

  
]


---

# Prerequisites

.scrollable.code120[


```r
# List of required (CRAN) packages
pkgs &lt;- c(
  "GGally",  # for gggplot2 extensions
  "pdp",     # for (corrected) Boston housing data
  "plotly",  # for interactive plots
  "tibble",  # for nicer data frames
  "vip"      # for variable importance plots
)

# Install required (CRAN) packages
for (pkg in pkgs) {
  if (!(pkg %in% installed.packages()[, "Package"])) {
    install.packages(pkg)
  }
}
```

]


---

# Multiple linear regression models

.font110[

Suppose that the yield in pounds of conversion in a chemical process depends on temperature and the catalyst concentration. A .darkorange[multiple linear regression] (MLR) model that might describe this relationship is `$$Y_i = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} + \epsilon_i, \quad i = 1, 2, \dots, n, \\ \epsilon_i \stackrel{iid}{\sim} \left(0, \sigma^2\right)$$`

Hence, the mean response is `$$E\left(Y_i\right) = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i}$$`

.center.content-box-yellow[

This is an MLR model in two features: `\(X_1\)` and `\(X_2\)`

]

]


---
class: clear

.code110[


```r
# Simulate data from an MLR model
set.seed(101)  # for reproducibility
n &lt;- 50
df &lt;- tibble::tibble(
  x1 = runif(n),
  x2 = runif(n),
* y = 1 + 2*x1 - 3*x2 + rnorm(n, sd = 1)
)
head(df, n = 3)  # print first few rows
```

```
## # A tibble: 3 x 3
##       x1     x2      y
##    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1 0.372  0.0792  0.357
## 2 0.0438 0.434  -0.488
## 3 0.710  0.680   0.958
```

]


---

# Scatterplot matrices

.font125[

Can be useful to plot pairwise scatterplots:

* Base R: `pairs()`

* **ggplot2**: `GGally::ggpairs()`

* **lattice**: `lattice::splom()`

* **car**: `car::scatterplotMatrix()` or `car::spm()`

]

.code125[


```r
# CExample
pairs(df, cex = 1.2, pch = 19, 
*     col = adjustcolor("darkred", alpha.f = 0.5))
```

]


---
class: clear, middle, center

&lt;img src="lecture-03_files/figure-html/mlr-3d-df-02-01-1.svg" width="100%" style="display: block; margin: auto;" /&gt;


---
class: clear, middle, center

.font300[

Interactive plots can be useful (for exploratory analysis) too!

https://plot.ly/r/

]


---
class: clear

.code120[


```r
*library(plotly)  # for interactive plotting

# Draw (interactive) 3-D scatterplot
plot_ly(data = df, x = ~x1, y = ~x2, z = ~y, 
        mode = "markers", type = "scatter3d",
        marker = list(opacity = 0.7, symbol = 1, 
                      size = 5, color = "black")) %&gt;%
  layout(
    scene = list(
      aspectmode = "manual", 
      aspectratio = list(x = 1, y = 1, z = 1),
      xaxis = list(title = "X1", range = c(0, 1)),
      yaxis = list(title = "X2", range = c(0, 1)),
      zaxis = list(title = "Y")
    )
  )
```

]


---
class: clear, middle, center

.scrollable[

<div id="htmlwidget-9b904639fb19e13bc578" style="width:100%;height:504px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-9b904639fb19e13bc578">{"x":{"visdat":{"6203e57dc55":["function () ","plotlyVisDat"]},"cur_data":"6203e57dc55","attrs":{"6203e57dc55":{"x":{},"y":{},"z":{},"mode":"markers","marker":{"opacity":0.7,"symbol":1,"size":5,"color":"black"},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"aspectmode":"manual","aspectratio":{"x":1,"y":1,"z":1},"xaxis":{"title":"X1","range":[0,1]},"yaxis":{"title":"X2","range":[0,1]},"zaxis":{"title":"Y"}},"hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[0.372198376338929,0.0438248154241592,0.709684018278494,0.657690396532416,0.249855723232031,0.30005483306013,0.584866625955328,0.333467143354937,0.622011963743716,0.54582855431363,0.879795730113983,0.706874740775675,0.731972594512627,0.931634427979589,0.455120594473556,0.590319729177281,0.820436094887555,0.224118480458856,0.411666829371825,0.0386105608195066,0.700711545301601,0.956837461562827,0.213352001970634,0.661061500199139,0.923318882007152,0.795719761401415,0.0712125543504953,0.389407767681405,0.406451216200367,0.659355078125373,0.423347146715969,0.320984446210787,0.197730733314529,0.163170094368979,0.523311075055972,0.913478652015328,0.206772719044238,0.814283016137779,0.0201671982649714,0.924804413458332,0.434961745981127,0.44205468473956,0.760689455317333,0.332961300387979,0.39435715181753,0.233294282807037,0.0716076579410583,0.913383485749364,0.771693573100492,0.107536639785394],"y":[0.0792122506536543,0.433889447478577,0.679774246877059,0.73435624060221,0.452510874019936,0.783785715699196,0.679835536982864,0.518703651148826,0.690805754158646,0.588275650283322,0.81458966806531,0.810044945916161,0.609935902291909,0.993409643415362,0.84324054280296,0.715503402985632,0.0190811885986477,0.30508025130257,0.882947984384373,0.941346816252917,0.23441800987348,0.936665828339756,0.566701976815239,0.842790403170511,0.821301179705188,0.279972854303196,0.0473011373542249,0.224940627580509,0.673092647222802,0.958930858410895,0.685259971302003,0.775802984833717,0.775838489178568,0.982794799143448,0.010188644984737,0.952585851075128,0.322935862233862,0.428005344932899,0.134496691403911,0.0183283127844334,0.656499502481893,0.914733336074278,0.715299851726741,0.182951447088271,0.240068171871826,0.836449080146849,0.385873456252739,0.232573804445565,0.0689206402748823,0.0622245285194367],"z":[0.356504719455528,-0.488489873403877,0.957946298786982,-1.28459057531883,0.891236540569034,-1.80243417790028,0.295607511587771,1.24063245375862,1.34532912924721,-0.101033074073126,0.0560203481925625,-1.42755839985382,-0.00722007193211782,-0.00450256513446001,-0.196876108323204,0.42096454061334,1.89583029789715,0.681898695673006,-0.883160042891964,-1.82164269204212,3.20806649910154,1.72361444604631,0.879756240480349,-0.283851804561905,-1.43620027589923,0.714076377157176,1.30301394228205,-0.173952514625109,-0.0680364616827005,-0.609066542742995,1.64306195445616,0.426235207458244,-1.44342932267249,-2.16592531250965,0.287128931522782,0.439949289756564,0.450124973558669,2.69259578302961,1.36094103561758,4.34717305322596,1.22589481623881,-0.894355731236911,0.0144659577966847,0.396902837202829,1.35052472138708,-1.83328433839026,-0.459309603604776,3.49403872754073,2.83407956367123,0.214003218171155],"mode":"markers","marker":{"color":"black","opacity":0.7,"symbol":1,"size":5,"line":{"color":"rgba(31,119,180,1)"}},"type":"scatter3d","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>

]


---
class: clear

.scrollable[


```r
# Fit an MLR model to the simulated data
*fit &lt;- lm(y ~ x1 + x2, data = df)
*(betas &lt;- coef(fit))
*## (Intercept)          x1          x2
*##   0.8834363   2.3265433  -2.9942737

*# Generate predictions over a fine grid
.x1 &lt;- .x2 &lt;- seq(from = 0, to = 1, length = 50)
yhat &lt;- t(outer(.x1, .x2, function(x1, x2) {
  betas[1] + betas[2]*x1 + betas[3]*x2
}))

# Draw (interactive) 3-D scatterplot with fitted mean response
plot_ly(x = ~.x1, y = ~.x2, z = ~yhat, 
        type = "surface", opacity = 0.7) %&gt;%
  add_trace(data = df, x = ~x1, y = ~x2, z = ~y, 
            mode = "markers", 
            type = "scatter3d",
            marker = list(opacity = 0.7, symbol = 1, 
                          size = 5, color = "black")) %&gt;%
  layout(
    scene = list(
      aspectmode = "manual", 
      aspectratio = list(x = 1, y = 1, z = 1),
      xaxis = list(title = "X1", range = c(0, 1)),
      yaxis = list(title = "X2", range = c(0, 1)),
      zaxis = list(title = "Y")
    )
  )
```

]


---
class: clear, middle, center

.scrollable[

<div id="htmlwidget-68d2887d03a45288f40a" style="width:100%;height:504px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-68d2887d03a45288f40a">{"x":{"visdat":{"62037f66813c":["function () ","plotlyVisDat"],"620322aecb7c":["function () ","data"]},"cur_data":"620322aecb7c","attrs":{"62037f66813c":{"x":{},"y":{},"z":{},"opacity":0.7,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface"},"620322aecb7c":{"x":{},"y":{},"z":{},"opacity":0.7,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","marker":{"opacity":0.7,"symbol":1,"size":5,"color":"black"},"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"aspectmode":"manual","aspectratio":{"x":1,"y":1,"z":1},"xaxis":{"title":"X1","range":[0,1]},"yaxis":{"title":"X2","range":[0,1]},"zaxis":{"title":"Y"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"showSendToCloud":false},"data":[{"colorbar":{"title":"yhat<br />y","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"x":[0,0.0204081632653061,0.0408163265306122,0.0612244897959184,0.0816326530612245,0.102040816326531,0.122448979591837,0.142857142857143,0.163265306122449,0.183673469387755,0.204081632653061,0.224489795918367,0.244897959183673,0.26530612244898,0.285714285714286,0.306122448979592,0.326530612244898,0.346938775510204,0.36734693877551,0.387755102040816,0.408163265306122,0.428571428571429,0.448979591836735,0.469387755102041,0.489795918367347,0.510204081632653,0.530612244897959,0.551020408163265,0.571428571428571,0.591836734693878,0.612244897959184,0.63265306122449,0.653061224489796,0.673469387755102,0.693877551020408,0.714285714285714,0.73469387755102,0.755102040816326,0.775510204081633,0.795918367346939,0.816326530612245,0.836734693877551,0.857142857142857,0.877551020408163,0.897959183673469,0.918367346938775,0.938775510204082,0.959183673469388,0.979591836734694,1],"y":[0,0.0204081632653061,0.0408163265306122,0.0612244897959184,0.0816326530612245,0.102040816326531,0.122448979591837,0.142857142857143,0.163265306122449,0.183673469387755,0.204081632653061,0.224489795918367,0.244897959183673,0.26530612244898,0.285714285714286,0.306122448979592,0.326530612244898,0.346938775510204,0.36734693877551,0.387755102040816,0.408163265306122,0.428571428571429,0.448979591836735,0.469387755102041,0.489795918367347,0.510204081632653,0.530612244897959,0.551020408163265,0.571428571428571,0.591836734693878,0.612244897959184,0.63265306122449,0.653061224489796,0.673469387755102,0.693877551020408,0.714285714285714,0.73469387755102,0.755102040816326,0.775510204081633,0.795918367346939,0.816326530612245,0.836734693877551,0.857142857142857,0.877551020408163,0.897959183673469,0.918367346938775,0.938775510204082,0.959183673469388,0.979591836734694,1],"z":[[0.883436313041809,0.930916789405538,0.978397265769267,1.025877742133,1.07335821849673,1.12083869486045,1.16831917122418,1.21579964758791,1.26328012395164,1.31076060031537,1.3582410766791,1.40572155304283,1.45320202940656,1.50068250577029,1.54816298213402,1.59564345849775,1.64312393486148,1.69060441122521,1.73808488758893,1.78556536395266,1.83304584031639,1.88052631668012,1.92800679304385,1.97548726940758,2.02296774577131,2.07044822213504,2.11792869849877,2.1654091748625,2.21288965122623,2.26037012758996,2.30785060395369,2.35533108031741,2.40281155668114,2.45029203304487,2.4977725094086,2.54525298577233,2.59273346213606,2.64021393849979,2.68769441486352,2.73517489122725,2.78265536759098,2.83013584395471,2.87761632031844,2.92509679668216,2.97257727304589,3.02005774940962,3.06753822577335,3.11501870213708,3.16249917850081,3.20997965486454],[0.822328686790561,0.86980916315429,0.91728963951802,0.964770115881749,1.01225059224548,1.05973106860921,1.10721154497294,1.15469202133667,1.20217249770039,1.24965297406412,1.29713345042785,1.34461392679158,1.39209440315531,1.43957487951904,1.48705535588277,1.5345358322465,1.58201630861023,1.62949678497396,1.67697726133769,1.72445773770142,1.77193821406515,1.81941869042887,1.8668991667926,1.91437964315633,1.96186011952006,2.00934059588379,2.05682107224752,2.10430154861125,2.15178202497498,2.19926250133871,2.24674297770244,2.29422345406617,2.3417039304299,2.38918440679363,2.43666488315735,2.48414535952108,2.53162583588481,2.57910631224854,2.62658678861227,2.674067264976,2.72154774133973,2.76902821770346,2.81650869406719,2.86398917043092,2.91146964679465,2.95895012315838,3.00643059952211,3.05391107588583,3.10139155224956,3.14887202861329],[0.761221060539313,0.808701536903043,0.856182013266772,0.903662489630501,0.95114296599423,0.99862344235796,1.04610391872169,1.09358439508542,1.14106487144915,1.18854534781288,1.23602582417661,1.28350630054033,1.33098677690406,1.37846725326779,1.42594772963152,1.47342820599525,1.52090868235898,1.56838915872271,1.61586963508644,1.66335011145017,1.7108305878139,1.75831106417763,1.80579154054136,1.85327201690509,1.90075249326881,1.94823296963254,1.99571344599627,2.04319392236,2.09067439872373,2.13815487508746,2.18563535145119,2.23311582781492,2.28059630417865,2.32807678054238,2.37555725690611,2.42303773326984,2.47051820963356,2.51799868599729,2.56547916236102,2.61295963872475,2.66044011508848,2.70792059145221,2.75540106781594,2.80288154417967,2.8503620205434,2.89784249690713,2.94532297327086,2.99280344963459,3.04028392599832,3.08776440236204],[0.700113434288066,0.747593910651795,0.795074387015524,0.842554863379253,0.890035339742983,0.937515816106712,0.984996292470441,1.03247676883417,1.0799572451979,1.12743772156163,1.17491819792536,1.22239867428909,1.26987915065282,1.31735962701655,1.36484010338027,1.412320579744,1.45980105610773,1.50728153247146,1.55476200883519,1.60224248519892,1.64972296156265,1.69720343792638,1.74468391429011,1.79216439065384,1.83964486701757,1.8871253433813,1.93460581974503,1.98208629610875,2.02956677247248,2.07704724883621,2.12452772519994,2.17200820156367,2.2194886779274,2.26696915429113,2.31444963065486,2.36193010701859,2.40941058338232,2.45689105974605,2.50437153610978,2.5518520124735,2.59933248883723,2.64681296520096,2.69429344156469,2.74177391792842,2.78925439429215,2.83673487065588,2.88421534701961,2.93169582338334,2.97917629974707,3.0266567761108],[0.639005808036818,0.686486284400547,0.733966760764277,0.781447237128006,0.828927713491735,0.876408189855464,0.923888666219193,0.971369142582923,1.01884961894665,1.06633009531038,1.11381057167411,1.16129104803784,1.20877152440157,1.2562520007653,1.30373247712903,1.35121295349276,1.39869342985649,1.44617390622021,1.49365438258394,1.54113485894767,1.5886153353114,1.63609581167513,1.68357628803886,1.73105676440259,1.77853724076632,1.82601771713005,1.87349819349378,1.92097866985751,1.96845914622124,2.01593962258497,2.06342009894869,2.11090057531242,2.15838105167615,2.20586152803988,2.25334200440361,2.30082248076734,2.34830295713107,2.3957834334948,2.44326390985853,2.49074438622226,2.53822486258599,2.58570533894972,2.63318581531344,2.68066629167717,2.7281467680409,2.77562724440463,2.82310772076836,2.87058819713209,2.91806867349582,2.96554914985955],[0.57789818178557,0.6253786581493,0.672859134513029,0.720339610876758,0.767820087240487,0.815300563604217,0.862781039967946,0.910261516331675,0.957741992695404,1.00522246905913,1.05270294542286,1.10018342178659,1.14766389815032,1.19514437451405,1.24262485087778,1.29010532724151,1.33758580360524,1.38506627996897,1.4325467563327,1.48002723269643,1.52750770906015,1.57498818542388,1.62246866178761,1.66994913815134,1.71742961451507,1.7649100908788,1.81239056724253,1.85987104360626,1.90735151996999,1.95483199633372,2.00231247269745,2.04979294906118,2.09727342542491,2.14475390178863,2.19223437815236,2.23971485451609,2.28719533087982,2.33467580724355,2.38215628360728,2.42963675997101,2.47711723633474,2.52459771269847,2.5720781890622,2.61955866542593,2.66703914178966,2.71451961815338,2.76200009451711,2.80948057088084,2.85696104724457,2.9044415236083],[0.516790555534323,0.564271031898052,0.611751508261781,0.65923198462551,0.70671246098924,0.754192937352969,0.801673413716698,0.849153890080427,0.896634366444156,0.944114842807886,0.991595319171615,1.03907579553534,1.08655627189907,1.1340367482628,1.18151722462653,1.22899770099026,1.27647817735399,1.32395865371772,1.37143913008145,1.41891960644518,1.46640008280891,1.51388055917264,1.56136103553637,1.60884151190009,1.65632198826382,1.70380246462755,1.75128294099128,1.79876341735501,1.84624389371874,1.89372437008247,1.9412048464462,1.98868532280993,2.03616579917366,2.08364627553739,2.13112675190112,2.17860722826484,2.22608770462857,2.2735681809923,2.32104865735603,2.36852913371976,2.41600961008349,2.46349008644722,2.51097056281095,2.55845103917468,2.60593151553841,2.65341199190214,2.70089246826587,2.7483729446296,2.79585342099332,2.84333389735705],[0.455682929283075,0.503163405646804,0.550643882010533,0.598124358374263,0.645604834737992,0.693085311101721,0.74056578746545,0.78804626382918,0.835526740192909,0.883007216556638,0.930487692920367,0.977968169284096,1.02544864564783,1.07292912201155,1.12040959837528,1.16789007473901,1.21537055110274,1.26285102746647,1.3103315038302,1.35781198019393,1.40529245655766,1.45277293292139,1.50025340928512,1.54773388564885,1.59521436201258,1.64269483837631,1.69017531474003,1.73765579110376,1.78513626746749,1.83261674383122,1.88009722019495,1.92757769655868,1.97505817292241,2.02253864928614,2.07001912564987,2.1174996020136,2.16498007837733,2.21246055474106,2.25994103110479,2.30742150746851,2.35490198383224,2.40238246019597,2.4498629365597,2.49734341292343,2.54482388928716,2.59230436565089,2.63978484201462,2.68726531837835,2.73474579474208,2.78222627110581],[0.394575303031827,0.442055779395557,0.489536255759286,0.537016732123015,0.584497208486744,0.631977684850474,0.679458161214203,0.726938637577932,0.774419113941661,0.82189959030539,0.869380066669119,0.916860543032849,0.964341019396578,1.01182149576031,1.05930197212404,1.10678244848777,1.15426292485149,1.20174340121522,1.24922387757895,1.29670435394268,1.34418483030641,1.39166530667014,1.43914578303387,1.4866262593976,1.53410673576133,1.58158721212506,1.62906768848879,1.67654816485252,1.72402864121625,1.77150911757997,1.8189895939437,1.86647007030743,1.91395054667116,1.96143102303489,2.00891149939862,2.05639197576235,2.10387245212608,2.15135292848981,2.19883340485354,2.24631388121727,2.293794357581,2.34127483394473,2.38875531030845,2.43623578667218,2.48371626303591,2.53119673939964,2.57867721576337,2.6261576921271,2.67363816849083,2.72111864485456],[0.33346767678058,0.380948153144309,0.428428629508038,0.475909105871767,0.523389582235497,0.570870058599226,0.618350534962955,0.665831011326684,0.713311487690413,0.760791964054143,0.808272440417872,0.855752916781601,0.90323339314533,0.95071386950906,0.998194345872789,1.04567482223652,1.09315529860025,1.14063577496398,1.18811625132771,1.23559672769143,1.28307720405516,1.33055768041889,1.37803815678262,1.42551863314635,1.47299910951008,1.52047958587381,1.56796006223754,1.61544053860127,1.662921014965,1.71040149132873,1.75788196769246,1.80536244405619,1.85284292041991,1.90032339678364,1.94780387314737,1.9952843495111,2.04276482587483,2.09024530223856,2.13772577860229,2.18520625496602,2.23268673132975,2.28016720769348,2.32764768405721,2.37512816042094,2.42260863678466,2.47008911314839,2.51756958951212,2.56505006587585,2.61253054223958,2.66001101860331],[0.272360050529332,0.319840526893061,0.367321003256791,0.41480147962052,0.462281955984249,0.509762432347978,0.557242908711707,0.604723385075437,0.652203861439166,0.699684337802895,0.747164814166624,0.794645290530353,0.842125766894083,0.889606243257812,0.937086719621541,0.98456719598527,1.032047672349,1.07952814871273,1.12700862507646,1.17448910144019,1.22196957780392,1.26945005416765,1.31693053053137,1.3644110068951,1.41189148325883,1.45937195962256,1.50685243598629,1.55433291235002,1.60181338871375,1.64929386507748,1.69677434144121,1.74425481780494,1.79173529416867,1.8392157705324,1.88669624689613,1.93417672325985,1.98165719962358,2.02913767598731,2.07661815235104,2.12409862871477,2.1715791050785,2.21905958144223,2.26654005780596,2.31402053416969,2.36150101053342,2.40898148689715,2.45646196326088,2.50394243962461,2.55142291598833,2.59890339235206],[0.211252424278084,0.258732900641814,0.306213377005543,0.353693853369272,0.401174329733001,0.448654806096731,0.49613528246046,0.543615758824189,0.591096235187918,0.638576711551647,0.686057187915377,0.733537664279106,0.781018140642835,0.828498617006564,0.875979093370293,0.923459569734022,0.970940046097752,1.01842052246148,1.06590099882521,1.11338147518894,1.16086195155267,1.2083424279164,1.25582290428013,1.30330338064386,1.35078385700759,1.39826433337131,1.44574480973504,1.49322528609877,1.5407057624625,1.58818623882623,1.63566671518996,1.68314719155369,1.73062766791742,1.77810814428115,1.82558862064488,1.87306909700861,1.92054957337234,1.96803004973607,2.01551052609979,2.06299100246352,2.11047147882725,2.15795195519098,2.20543243155471,2.25291290791844,2.30039338428217,2.3478738606459,2.39535433700963,2.44283481337336,2.49031528973709,2.53779576610082],[0.150144798026837,0.197625274390566,0.245105750754295,0.292586227118024,0.340066703481753,0.387547179845483,0.435027656209212,0.482508132572941,0.52998860893667,0.5774690853004,0.624949561664129,0.672430038027858,0.719910514391587,0.767390990755316,0.814871467119046,0.862351943482775,0.909832419846504,0.957312896210233,1.00479337257396,1.05227384893769,1.09975432530142,1.14723480166515,1.19471527802888,1.24219575439261,1.28967623075634,1.33715670712007,1.3846371834838,1.43211765984753,1.47959813621125,1.52707861257498,1.57455908893871,1.62203956530244,1.66952004166617,1.7170005180299,1.76448099439363,1.81196147075736,1.85944194712109,1.90692242348482,1.95440289984855,2.00188337621228,2.049363852576,2.09684432893973,2.14432480530346,2.19180528166719,2.23928575803092,2.28676623439465,2.33424671075838,2.38172718712211,2.42920766348584,2.47668813984957],[0.0890371717755891,0.136517648139318,0.183998124503048,0.231478600866777,0.278959077230506,0.326439553594235,0.373920029957964,0.421400506321694,0.468880982685423,0.516361459049152,0.563841935412881,0.61132241177661,0.65880288814034,0.706283364504069,0.753763840867798,0.801244317231527,0.848724793595256,0.896205269958986,0.943685746322715,0.991166222686444,1.03864669905017,1.0861271754139,1.13360765177763,1.18108812814136,1.22856860450509,1.27604908086882,1.32352955723255,1.37101003359628,1.41849050996001,1.46597098632374,1.51345146268747,1.56093193905119,1.60841241541492,1.65589289177865,1.70337336814238,1.75085384450611,1.79833432086984,1.84581479723357,1.8932952735973,1.94077574996103,1.98825622632476,2.03573670268849,2.08321717905222,2.13069765541595,2.17817813177967,2.2256586081434,2.27313908450713,2.32061956087086,2.36810003723459,2.41558051359832],[0.0279295455243413,0.0754100218880706,0.1228904982518,0.170370974615529,0.217851450979258,0.265331927342987,0.312812403706717,0.360292880070446,0.407773356434175,0.455253832797904,0.502734309161633,0.550214785525363,0.597695261889092,0.645175738252821,0.69265621461655,0.740136690980279,0.787617167344009,0.835097643707738,0.882578120071467,0.930058596435196,0.977539072798925,1.02501954916265,1.07250002552638,1.11998050189011,1.16746097825384,1.21494145461757,1.2624219309813,1.30990240734503,1.35738288370876,1.40486336007249,1.45234383643622,1.49982431279995,1.54730478916368,1.59478526552741,1.64226574189113,1.68974621825486,1.73722669461859,1.78470717098232,1.83218764734605,1.87966812370978,1.92714860007351,1.97462907643724,2.02210955280097,2.0695900291647,2.11707050552843,2.16455098189216,2.21203145825589,2.25951193461961,2.30699241098334,2.35447288734707],[-0.0331780807269062,0.014302395636823,0.0617828720005522,0.109263348364282,0.156743824728011,0.20422430109174,0.251704777455469,0.299185253819198,0.346665730182927,0.394146206546657,0.441626682910386,0.489107159274115,0.536587635637845,0.584068112001574,0.631548588365303,0.679029064729032,0.726509541092761,0.77399001745649,0.82147049382022,0.868950970183949,0.916431446547678,0.963911922911407,1.01139239927514,1.05887287563887,1.10635335200259,1.15383382836632,1.20131430473005,1.24879478109378,1.29627525745751,1.34375573382124,1.39123621018497,1.4387166865487,1.48619716291243,1.53367763927616,1.58115811563989,1.62863859200362,1.67611906836735,1.72359954473107,1.7710800210948,1.81856049745853,1.86604097382226,1.91352145018599,1.96100192654972,2.00848240291345,2.05596287927718,2.10344335564091,2.15092383200464,2.19840430836837,2.2458847847321,2.29336526109583],[-0.094285706978154,-0.0468052306144248,0.000675245749304443,0.0481557221130338,0.0956361984767629,0.143116674840492,0.190597151204221,0.238077627567951,0.28555810393168,0.333038580295409,0.380519056659138,0.427999533022867,0.475480009386597,0.522960485750326,0.570440962114055,0.617921438477784,0.665401914841513,0.712882391205243,0.760362867568972,0.807843343932701,0.85532382029643,0.902804296660159,0.950284773023889,0.997765249387618,1.04524572575135,1.09272620211508,1.14020667847881,1.18768715484253,1.23516763120626,1.28264810756999,1.33012858393372,1.37760906029745,1.42508953666118,1.47257001302491,1.52005048938864,1.56753096575237,1.6150114421161,1.66249191847983,1.70997239484356,1.75745287120728,1.80493334757101,1.85241382393474,1.89989430029847,1.9473747766622,1.99485525302593,2.04233572938966,2.08981620575339,2.13729668211712,2.18477715848085,2.23225763484458],[-0.155393333229402,-0.107912856865673,-0.0604323805019433,-0.012951904138214,0.0345285722255151,0.0820090485892444,0.129489524952974,0.176970001316703,0.224450477680432,0.271930954044161,0.31941143040789,0.366891906771619,0.414372383135349,0.461852859499078,0.509333335862807,0.556813812226536,0.604294288590266,0.651774764953995,0.699255241317724,0.746735717681453,0.794216194045182,0.841696670408912,0.889177146772641,0.93665762313637,0.984138099500099,1.03161857586383,1.07909905222756,1.12657952859129,1.17406000495502,1.22154048131875,1.26902095768247,1.3165014340462,1.36398191040993,1.41146238677366,1.45894286313739,1.50642333950112,1.55390381586485,1.60138429222858,1.64886476859231,1.69634524495604,1.74382572131977,1.7913061976835,1.83878667404722,1.88626715041095,1.93374762677468,1.98122810313841,2.02870857950214,2.07618905586587,2.1236695322296,2.17115000859333],[-0.216500959480649,-0.16902048311692,-0.121540006753191,-0.0740595303894616,-0.0265790540257325,0.0209014223379969,0.068381898701726,0.115862375065455,0.163342851429184,0.210823327792914,0.258303804156643,0.305784280520372,0.353264756884101,0.400745233247831,0.44822570961156,0.495706185975289,0.543186662339018,0.590667138702747,0.638147615066476,0.685628091430206,0.733108567793935,0.780589044157664,0.828069520521393,0.875549996885123,0.923030473248852,0.970510949612581,1.01799142597631,1.06547190234004,1.11295237870377,1.1604328550675,1.20791333143123,1.25539380779496,1.30287428415869,1.35035476052241,1.39783523688614,1.44531571324987,1.4927961896136,1.54027666597733,1.58775714234106,1.63523761870479,1.68271809506852,1.73019857143225,1.77767904779598,1.82515952415971,1.87264000052344,1.92012047688716,1.96760095325089,2.01508142961462,2.06256190597835,2.11004238234208],[-0.277608585731897,-0.230128109368168,-0.182647633004439,-0.135167156640709,-0.0876866802769802,-0.0402062039132509,0.00727427245047818,0.0547547488142075,0.102235225177937,0.149715701541666,0.197196177905395,0.244676654269124,0.292157130632854,0.339637606996583,0.387118083360312,0.434598559724041,0.48207903608777,0.5295595124515,0.577039988815229,0.624520465178958,0.672000941542687,0.719481417906416,0.766961894270145,0.814442370633875,0.861922846997604,0.909403323361333,0.956883799725062,1.00436427608879,1.05184475245252,1.09932522881625,1.14680570517998,1.19428618154371,1.24176665790744,1.28924713427117,1.3367276106349,1.38420808699863,1.43168856336235,1.47916903972608,1.52664951608981,1.57412999245354,1.62161046881727,1.669090945181,1.71657142154473,1.76405189790846,1.81153237427219,1.85901285063592,1.90649332699965,1.95397380336338,2.00145427972711,2.04893475609083],[-0.338716211983145,-0.291235735619415,-0.243755259255686,-0.196274782891957,-0.148794306528228,-0.101313830164498,-0.0538333538007694,-0.00635287743704005,0.041127598926689,0.0886080752904184,0.136088551654147,0.183569028017877,0.231049504381606,0.278529980745335,0.326010457109064,0.373490933472793,0.420971409836523,0.468451886200252,0.515932362563981,0.56341283892771,0.61089331529144,0.658373791655169,0.705854268018898,0.753334744382627,0.800815220746357,0.848295697110086,0.895776173473815,0.943256649837544,0.990737126201273,1.038217602565,1.08569807892873,1.13317855529246,1.18065903165619,1.22813950801992,1.27561998438365,1.32310046074738,1.37058093711111,1.41806141347484,1.46554188983857,1.51302236620229,1.56050284256602,1.60798331892975,1.65546379529348,1.70294427165721,1.75042474802094,1.79790522438467,1.8453857007484,1.89286617711213,1.94034665347586,1.98782712983959],[-0.399823838234392,-0.352343361870663,-0.304862885506934,-0.257382409143205,-0.209901932779476,-0.162421456415746,-0.114940980052017,-0.0674605036882878,-0.0199800273245587,0.0275004490391706,0.0749809254028997,0.122461401766629,0.169941878130358,0.217422354494087,0.264902830857817,0.312383307221546,0.359863783585275,0.407344259949004,0.454824736312733,0.502305212676463,0.549785689040192,0.597266165403921,0.64474664176765,0.692227118131379,0.739707594495109,0.787188070858838,0.834668547222567,0.882149023586296,0.929629499950026,0.977109976313755,1.02459045267748,1.07207092904121,1.11955140540494,1.16703188176867,1.2145123581324,1.26199283449613,1.30947331085986,1.35695378722359,1.40443426358732,1.45191473995105,1.49939521631478,1.54687569267851,1.59435616904223,1.64183664540596,1.68931712176969,1.73679759813342,1.78427807449715,1.83175855086088,1.87923902722461,1.92671950358834],[-0.46093146448564,-0.413450988121911,-0.365970511758182,-0.318490035394452,-0.271009559030723,-0.223529082666994,-0.176048606303265,-0.128568129939535,-0.0810876535758063,-0.033607177212077,0.0138732991516521,0.0613537755153812,0.108834251879111,0.15631472824284,0.203795204606569,0.251275680970298,0.298756157334027,0.346236633697757,0.393717110061486,0.441197586425215,0.488678062788944,0.536158539152674,0.583639015516403,0.631119491880132,0.678599968243861,0.72608044460759,0.773560920971319,0.821041397335049,0.868521873698778,0.916002350062507,0.963482826426236,1.01096330278997,1.05844377915369,1.10592425551742,1.15340473188115,1.20088520824488,1.24836568460861,1.29584616097234,1.34332663733607,1.3908071136998,1.43828759006353,1.48576806642726,1.53324854279099,1.58072901915472,1.62820949551844,1.67568997188217,1.7231704482459,1.77065092460963,1.81813140097336,1.86561187733709],[-0.522039090736888,-0.474558614373158,-0.427078138009429,-0.3795976616457,-0.332117185281971,-0.284636708918242,-0.237156232554512,-0.189675756190783,-0.142195279827054,-0.0947148034633247,-0.0472343270995956,0.000246149264133466,0.047726625627863,0.0952071019915921,0.142687578355321,0.19016805471905,0.23764853108278,0.285129007446509,0.332609483810238,0.380089960173967,0.427570436537696,0.475050912901426,0.522531389265155,0.570011865628884,0.617492341992613,0.664972818356343,0.712453294720072,0.759933771083801,0.80741424744753,0.854894723811259,0.902375200174989,0.949855676538718,0.997336152902447,1.04481662926618,1.09229710562991,1.13977758199363,1.18725805835736,1.23473853472109,1.28221901108482,1.32969948744855,1.37717996381228,1.42466044017601,1.47214091653974,1.51962139290347,1.5671018692672,1.61458234563093,1.66206282199466,1.70954329835839,1.75702377472211,1.80450425108584],[-0.583146716988135,-0.535666240624406,-0.488185764260677,-0.440705287896948,-0.393224811533219,-0.345744335169489,-0.29826385880576,-0.250783382442031,-0.203302906078302,-0.155822429714572,-0.108341953350843,-0.0608614769871143,-0.0133810006233848,0.0340994757403443,0.0815799521040734,0.129060428467803,0.176540904831532,0.224021381195261,0.27150185755899,0.31898233392272,0.366462810286449,0.413943286650178,0.461423763013907,0.508904239377636,0.556384715741366,0.603865192105095,0.651345668468824,0.698826144832553,0.746306621196283,0.793787097560012,0.841267573923741,0.88874805028747,0.936228526651199,0.983709003014928,1.03118947937866,1.07866995574239,1.12615043210612,1.17363090846985,1.22111138483357,1.2685918611973,1.31607233756103,1.36355281392476,1.41103329028849,1.45851376665222,1.50599424301595,1.55347471937968,1.60095519574341,1.64843567210714,1.69591614847087,1.7433966248346],[-0.644254343239383,-0.596773866875654,-0.549293390511925,-0.501812914148195,-0.454332437784466,-0.406851961420737,-0.359371485057008,-0.311891008693278,-0.264410532329549,-0.21693005596582,-0.169449579602091,-0.121969103238362,-0.0744886268746323,-0.0270081505109032,0.0204723258528259,0.067952802216555,0.115433278580284,0.162913754944014,0.210394231307743,0.257874707671472,0.305355184035201,0.35283566039893,0.40031613676266,0.447796613126389,0.495277089490118,0.542757565853847,0.590238042217576,0.637718518581305,0.685198994945035,0.732679471308764,0.780159947672493,0.827640424036223,0.875120900399952,0.922601376763681,0.97008185312741,1.01756232949114,1.06504280585487,1.1125232822186,1.16000375858233,1.20748423494606,1.25496471130979,1.30244518767351,1.34992566403724,1.39740614040097,1.4448866167647,1.49236709312843,1.53984756949216,1.58732804585589,1.63480852221962,1.68228899858335],[-0.705361969490631,-0.657881493126901,-0.610401016763172,-0.562920540399443,-0.515440064035714,-0.467959587671984,-0.420479111308255,-0.372998634944526,-0.325518158580797,-0.278037682217068,-0.230557205853338,-0.183076729489609,-0.13559625312588,-0.0881157767621508,-0.0406353003984217,0.00684517596530743,0.0543256523290367,0.101806128692766,0.149286605056495,0.196767081420224,0.244247557783954,0.291728034147683,0.339208510511412,0.386688986875141,0.434169463238871,0.4816499396026,0.529130415966329,0.576610892330058,0.624091368693787,0.671571845057517,0.719052321421246,0.766532797784975,0.814013274148704,0.861493750512433,0.908974226876162,0.956454703239892,1.00393517960362,1.05141565596735,1.09889613233108,1.14637660869481,1.19385708505854,1.24133756142227,1.288818037786,1.33629851414973,1.38377899051345,1.43125946687718,1.47873994324091,1.52622041960464,1.57370089596837,1.6211813723321],[-0.766469595741878,-0.718989119378149,-0.67150864301442,-0.624028166650691,-0.576547690286962,-0.529067213923232,-0.481586737559503,-0.434106261195774,-0.386625784832045,-0.339145308468315,-0.291664832104586,-0.244184355740857,-0.196703879377128,-0.149223403013399,-0.101742926649669,-0.0542624502859403,-0.00678197392221103,0.0406985024415183,0.0881789788052474,0.135659455168977,0.183139931532706,0.230620407896435,0.278100884260164,0.325581360623894,0.373061836987623,0.420542313351352,0.468022789715081,0.51550326607881,0.56298374244254,0.610464218806269,0.657944695169998,0.705425171533727,0.752905647897457,0.800386124261186,0.847866600624915,0.895347076988644,0.942827553352373,0.990308029716102,1.03778850607983,1.08526898244356,1.13274945880729,1.18022993517102,1.22771041153475,1.27519088789848,1.32267136426221,1.37015184062594,1.41763231698967,1.46511279335339,1.51259326971712,1.56007374608085],[-0.827577221993126,-0.780096745629397,-0.732616269265668,-0.685135792901938,-0.637655316538209,-0.59017484017448,-0.542694363810751,-0.495213887447022,-0.447733411083292,-0.400252934719563,-0.352772458355834,-0.305291981992105,-0.257811505628375,-0.210331029264646,-0.162850552900917,-0.115370076537188,-0.0678896001734588,-0.0204091238097295,0.0270713525539996,0.0745518289177289,0.122032305281458,0.169512781645187,0.216993258008916,0.264473734372646,0.311954210736375,0.359434687100104,0.406915163463833,0.454395639827562,0.501876116191292,0.549356592555021,0.59683706891875,0.64431754528248,0.691798021646209,0.739278498009938,0.786758974373667,0.834239450737396,0.881719927101125,0.929200403464855,0.976680879828584,1.02416135619231,1.07164183255604,1.11912230891977,1.1666027852835,1.21408326164723,1.26156373801096,1.30904421437469,1.35652469073842,1.40400516710215,1.45148564346588,1.49896611982961],[-0.888684848244374,-0.841204371880644,-0.793723895516915,-0.746243419153186,-0.698762942789457,-0.651282466425728,-0.603801990061998,-0.556321513698269,-0.50884103733454,-0.461360560970811,-0.413880084607082,-0.366399608243352,-0.318919131879623,-0.271438655515894,-0.223958179152165,-0.176477702788436,-0.128997226424706,-0.081516750060977,-0.0340362736972479,0.0134442026664814,0.0609246790302105,0.10840515539394,0.155885631757669,0.203366108121398,0.250846584485128,0.298327060848857,0.345807537212586,0.393288013576315,0.440768489940044,0.488248966303773,0.535729442667503,0.583209919031232,0.630690395394961,0.67817087175869,0.725651348122419,0.773131824486148,0.820612300849878,0.868092777213607,0.915573253577337,0.963053729941065,1.01053420630479,1.05801468266852,1.10549515903225,1.15297563539598,1.20045611175971,1.24793658812344,1.29541706448717,1.3428975408509,1.39037801721463,1.43785849357836],[-0.949792474495621,-0.902311998131892,-0.854831521768163,-0.807351045404433,-0.759870569040704,-0.712390092676975,-0.664909616313246,-0.617429139949517,-0.569948663585788,-0.522468187222058,-0.474987710858329,-0.4275072344946,-0.380026758130871,-0.332546281767141,-0.285065805403412,-0.237585329039683,-0.190104852675954,-0.142624376312225,-0.0951438999484955,-0.0476634235847662,-0.000182947221037066,0.0472975291426923,0.0947780055064213,0.142258481870151,0.18973895823388,0.237219434597609,0.284699910961338,0.332180387325067,0.379660863688797,0.427141340052526,0.474621816416255,0.522102292779985,0.569582769143714,0.617063245507443,0.664543721871172,0.712024198234901,0.75950467459863,0.80698515096236,0.854465627326089,0.901946103689818,0.949426580053547,0.996907056417276,1.04438753278101,1.09186800914473,1.13934848550846,1.18682896187219,1.23430943823592,1.28178991459965,1.32927039096338,1.37675086732711],[-1.01090010074687,-0.96341962438314,-0.915939148019411,-0.868458671655681,-0.820978195291952,-0.773497718928223,-0.726017242564494,-0.678536766200764,-0.631056289837035,-0.583575813473306,-0.536095337109577,-0.488614860745848,-0.441134384382118,-0.393653908018389,-0.34617343165466,-0.298692955290931,-0.251212478927202,-0.203732002563472,-0.156251526199743,-0.108771049836014,-0.0612905734722848,-0.0138100971085555,0.0336703792551736,0.0811508556189029,0.128631331982632,0.176111808346361,0.22359228471009,0.27107276107382,0.318553237437549,0.366033713801278,0.413514190165007,0.460994666528737,0.508475142892466,0.555955619256195,0.603436095619924,0.650916571983653,0.698397048347382,0.745877524711112,0.793358001074841,0.84083847743857,0.8883189538023,0.935799430166029,0.983279906529758,1.03076038289349,1.07824085925722,1.12572133562095,1.17320181198467,1.2206822883484,1.26816276471213,1.31564324107586],[-1.07200772699812,-1.02452725063439,-0.977046774270658,-0.929566297906929,-0.8820858215432,-0.834605345179471,-0.787124868815742,-0.739644392452012,-0.692163916088283,-0.644683439724554,-0.597202963360825,-0.549722486997096,-0.502242010633366,-0.454761534269637,-0.407281057905908,-0.359800581542179,-0.312320105178449,-0.26483962881472,-0.217359152450991,-0.169878676087262,-0.122398199723533,-0.0749177233598033,-0.0274372469960742,0.0200432293676551,0.0675237057313844,0.115004182095114,0.162484658458843,0.209965134822572,0.257445611186301,0.30492608755003,0.352406563913759,0.399887040277489,0.447367516641218,0.494847993004947,0.542328469368676,0.589808945732405,0.637289422096134,0.684769898459864,0.732250374823594,0.779730851187322,0.827211327551052,0.874691803914781,0.92217228027851,0.969652756642239,1.01713323300597,1.0646137093697,1.11209418573343,1.15957466209716,1.20705513846089,1.25453561482461],[-1.13311535324936,-1.08563487688563,-1.03815440052191,-0.990673924158177,-0.943193447794447,-0.895712971430718,-0.848232495066989,-0.80075201870326,-0.753271542339531,-0.705791065975801,-0.658310589612072,-0.610830113248343,-0.563349636884614,-0.515869160520884,-0.468388684157155,-0.420908207793426,-0.373427731429697,-0.325947255065968,-0.278466778702239,-0.230986302338509,-0.18350582597478,-0.136025349611051,-0.0885448732473217,-0.0410643968835924,0.00641607948013689,0.053896555843866,0.101377032207595,0.148857508571324,0.196337984935054,0.243818461298783,0.291298937662512,0.338779414026241,0.386259890389971,0.4337403667537,0.481220843117429,0.528701319481158,0.576181795844887,0.623662272208616,0.671142748572346,0.718623224936075,0.766103701299804,0.813584177663533,0.861064654027262,0.908545130390991,0.956025606754721,1.00350608311845,1.05098655948218,1.09846703584591,1.14594751220964,1.19342798857337],[-1.19422297950061,-1.14674250313688,-1.09926202677315,-1.05178155040942,-1.0043010740457,-0.956820597681966,-0.909340121318237,-0.861859644954508,-0.814379168590779,-0.766898692227049,-0.71941821586332,-0.671937739499591,-0.624457263135862,-0.576976786772132,-0.529496310408403,-0.482015834044674,-0.434535357680945,-0.387054881317216,-0.339574404953487,-0.292093928589757,-0.244613452226028,-0.197132975862299,-0.14965249949857,-0.10217202313484,-0.0546915467711111,-0.007211070407382,0.0402694059563471,0.0877498823200762,0.135230358683806,0.182710835047535,0.230191311411264,0.277671787774993,0.325152264138723,0.372632740502452,0.420113216866181,0.46759369322991,0.515074169593639,0.562554645957368,0.610035122321098,0.657515598684827,0.704996075048556,0.752476551412285,0.799957027776014,0.847437504139744,0.894917980503473,0.942398456867202,0.989878933230932,1.03735940959466,1.08483988595839,1.13232036232212],[-1.25533060575186,-1.20785012938813,-1.1603696530244,-1.11288917666067,-1.06540870029694,-1.01792822393321,-0.970447747569484,-0.922967271205755,-0.875486794842026,-0.828006318478296,-0.780525842114567,-0.733045365750838,-0.685564889387109,-0.63808441302338,-0.59060393665965,-0.543123460295921,-0.495642983932192,-0.448162507568463,-0.400682031204734,-0.353201554841004,-0.305721078477275,-0.258240602113546,-0.210760125749817,-0.163279649386088,-0.115799173022358,-0.0683186966586291,-0.0208382202949,0.0266422560688291,0.0741227324325586,0.121603208796288,0.169083685160017,0.216564161523746,0.264044637887475,0.311525114251205,0.359005590614934,0.406486066978663,0.453966543342392,0.501447019706121,0.548927496069851,0.59640797243358,0.643888448797309,0.691368925161038,0.738849401524767,0.786329877888496,0.833810354252225,0.881290830615955,0.928771306979685,0.976251783343414,1.02373225970714,1.07121273607087],[-1.31643823200311,-1.26895775563938,-1.22147727927565,-1.17399680291192,-1.12651632654819,-1.07903585018446,-1.03155537382073,-0.984074897457003,-0.936594421093274,-0.889113944729544,-0.841633468365815,-0.794152992002086,-0.746672515638357,-0.699192039274628,-0.651711562910898,-0.604231086547169,-0.55675061018344,-0.509270133819711,-0.461789657455982,-0.414309181092252,-0.366828704728523,-0.319348228364794,-0.271867752001065,-0.224387275637336,-0.176906799273606,-0.129426322909877,-0.081945846546148,-0.0344653701824189,0.0130151061813106,0.0604955825450397,0.107976058908769,0.155456535272498,0.202937011636227,0.250417487999957,0.297897964363686,0.345378440727415,0.392858917091144,0.440339393454873,0.487819869818603,0.535300346182332,0.582780822546061,0.63026129890979,0.677741775273519,0.725222251637248,0.772702728000978,0.820183204364707,0.867663680728437,0.915144157092166,0.962624633455895,1.01010510981962],[-1.37754585825435,-1.33006538189063,-1.2825849055269,-1.23510442916317,-1.18762395279944,-1.14014347643571,-1.09266300007198,-1.04518252370825,-0.997702047344521,-0.950221570980792,-0.902741094617063,-0.855260618253334,-0.807780141889604,-0.760299665525875,-0.712819189162146,-0.665338712798417,-0.617858236434688,-0.570377760070958,-0.522897283707229,-0.4754168073435,-0.427936330979771,-0.380455854616041,-0.332975378252312,-0.285494901888583,-0.238014425524854,-0.190533949161125,-0.143053472797396,-0.0955729964336665,-0.0480925200699369,-0.000612043706207821,0.0468684326575213,0.0943489090212508,0.14182938538498,0.189309861748709,0.236790338112438,0.284270814476167,0.331751290839896,0.379231767203626,0.426712243567355,0.474192719931084,0.521673196294814,0.569153672658543,0.616634149022272,0.664114625386001,0.71159510174973,0.759075578113459,0.806556054477189,0.854036530840918,0.901517007204647,0.948997483568376],[-1.4386534845056,-1.39117300814187,-1.34369253177814,-1.29621205541442,-1.24873157905069,-1.20125110268696,-1.15377062632323,-1.1062901499595,-1.05880967359577,-1.01132919723204,-0.963848720868311,-0.916368244504582,-0.868887768140852,-0.821407291777123,-0.773926815413394,-0.726446339049665,-0.678965862685936,-0.631485386322206,-0.584004909958477,-0.536524433594748,-0.489043957231019,-0.441563480867289,-0.39408300450356,-0.346602528139831,-0.299122051776102,-0.251641575412373,-0.204161099048644,-0.156680622684914,-0.109200146321185,-0.0617196699574558,-0.0142391935937267,0.0332412827700028,0.0807217591337319,0.128202235497461,0.17568271186119,0.223163188224919,0.270643664588648,0.318124140952378,0.365604617316107,0.413085093679836,0.460565570043566,0.508046046407295,0.555526522771024,0.603006999134753,0.650487475498482,0.697967951862211,0.745448428225941,0.79292890458967,0.840409380953399,0.887889857317128],[-1.49976111075685,-1.45228063439312,-1.40480015802939,-1.35731968166566,-1.30983920530193,-1.2623587289382,-1.21487825257447,-1.16739777621075,-1.11991729984702,-1.07243682348329,-1.02495634711956,-0.977475870755829,-0.929995394392099,-0.88251491802837,-0.835034441664641,-0.787553965300912,-0.740073488937183,-0.692593012573453,-0.645112536209724,-0.597632059845995,-0.550151583482266,-0.502671107118537,-0.455190630754807,-0.407710154391078,-0.360229678027349,-0.31274920166362,-0.265268725299891,-0.217788248936162,-0.170307772572432,-0.122827296208703,-0.0753468198449738,-0.0278663434812443,0.0196141328824848,0.0670946092462139,0.114575085609943,0.162055561973672,0.209536038337401,0.257016514701131,0.30449699106486,0.351977467428589,0.399457943792318,0.446938420156048,0.494418896519777,0.541899372883506,0.589379849247235,0.636860325610964,0.684340801974694,0.731821278338423,0.779301754702152,0.826782231065881],[-1.5608687370081,-1.51338826064437,-1.46590778428064,-1.41842730791691,-1.37094683155318,-1.32346635518945,-1.27598587882572,-1.22850540246199,-1.18102492609826,-1.13354444973454,-1.08606397337081,-1.03858349700708,-0.991103020643347,-0.943622544279618,-0.896142067915889,-0.84866159155216,-0.801181115188431,-0.753700638824701,-0.706220162460972,-0.658739686097243,-0.611259209733514,-0.563778733369785,-0.516298257006055,-0.468817780642326,-0.421337304278597,-0.373856827914868,-0.326376351551139,-0.27889587518741,-0.23141539882368,-0.183934922459951,-0.136454446096222,-0.0889739697324923,-0.0414934933687632,0.00598698299496592,0.053467459358695,0.100947935722424,0.148428412086153,0.195908888449883,0.243389364813612,0.290869841177341,0.33835031754107,0.3858307939048,0.433311270268529,0.480791746632258,0.528272222995987,0.575752699359716,0.623233175723446,0.670713652087175,0.718194128450904,0.765674604814633],[-1.62197636325935,-1.57449588689562,-1.52701541053189,-1.47953493416816,-1.43205445780443,-1.3845739814407,-1.33709350507697,-1.28961302871324,-1.24213255234951,-1.19465207598578,-1.14717159962205,-1.09969112325832,-1.05221064689459,-1.00473017053087,-0.957249694167137,-0.909769217803408,-0.862288741439678,-0.814808265075949,-0.76732778871222,-0.719847312348491,-0.672366835984761,-0.624886359621032,-0.577405883257303,-0.529925406893574,-0.482444930529844,-0.434964454166115,-0.387483977802386,-0.340003501438657,-0.292523025074928,-0.245042548711198,-0.197562072347469,-0.15008159598374,-0.102601119620011,-0.0551206432562816,-0.00764016689255254,0.0398403094711766,0.0873207858349057,0.134801262198635,0.182281738562365,0.229762214926093,0.277242691289823,0.324723167653552,0.372203644017281,0.41968412038101,0.467164596744739,0.514645073108468,0.562125549472198,0.609606025835927,0.657086502199657,0.704566978563386],[-1.68308398951059,-1.63560351314686,-1.58812303678314,-1.54064256041941,-1.49316208405568,-1.44568160769195,-1.39820113132822,-1.35072065496449,-1.30324017860076,-1.25575970223703,-1.2082792258733,-1.16079874950957,-1.11331827314584,-1.06583779678211,-1.01835732041838,-0.970876844054656,-0.923396367690926,-0.875915891327197,-0.828435414963468,-0.780954938599739,-0.733474462236009,-0.68599398587228,-0.638513509508551,-0.591033033144822,-0.543552556781092,-0.496072080417363,-0.448591604053634,-0.401111127689905,-0.353630651326176,-0.306150174962446,-0.258669698598717,-0.211189222234988,-0.163708745871259,-0.11622826950753,-0.0687477931438005,-0.0212673167800714,0.0262131595836577,0.0736936359473872,0.121174112311117,0.168654588674845,0.216135065038575,0.263615541402304,0.311096017766033,0.358576494129762,0.406056970493491,0.45353744685722,0.50101792322095,0.548498399584679,0.595978875948409,0.643459352312138],[-1.74419161576184,-1.69671113939811,-1.64923066303438,-1.60175018667065,-1.55426971030692,-1.50678923394319,-1.45930875757947,-1.41182828121574,-1.36434780485201,-1.31686732848828,-1.26938685212455,-1.22190637576082,-1.17442589939709,-1.12694542303336,-1.07946494666963,-1.0319844703059,-0.984503993942174,-0.937023517578444,-0.889543041214715,-0.842062564850986,-0.794582088487257,-0.747101612123528,-0.699621135759799,-0.652140659396069,-0.60466018303234,-0.557179706668611,-0.509699230304882,-0.462218753941153,-0.414738277577423,-0.367257801213694,-0.319777324849965,-0.272296848486235,-0.224816372122506,-0.177335895758777,-0.129855419395048,-0.082374943031319,-0.0348944666675899,0.0125860096961397,0.0600664860598692,0.107546962423598,0.155027438787327,0.202507915151056,0.249988391514786,0.297468867878515,0.344949344242244,0.392429820605973,0.439910296969703,0.487390773333432,0.534871249697161,0.58235172606089],[-1.80529924201309,-1.75781876564936,-1.71033828928563,-1.6628578129219,-1.61537733655817,-1.56789686019444,-1.52041638383071,-1.47293590746698,-1.42545543110326,-1.37797495473953,-1.3304944783758,-1.28301400201207,-1.23553352564834,-1.18805304928461,-1.14057257292088,-1.09309209655715,-1.04561162019342,-0.998131143829692,-0.950650667465963,-0.903170191102234,-0.855689714738505,-0.808209238374775,-0.760728762011046,-0.713248285647317,-0.665767809283587,-0.618287332919858,-0.570806856556129,-0.5233263801924,-0.475845903828671,-0.428365427464942,-0.380884951101212,-0.333404474737483,-0.285923998373754,-0.238443522010025,-0.190963045646296,-0.143482569282567,-0.0960020929188374,-0.0485216165551079,-0.00104114019137835,0.0464393361723503,0.0939198125360798,0.141400288899809,0.188880765263538,0.236361241627267,0.283841717990996,0.331322194354725,0.378802670718455,0.426283147082184,0.473763623445913,0.521244099809643],[-1.86640686826434,-1.81892639190061,-1.77144591553688,-1.72396543917315,-1.67648496280942,-1.62900448644569,-1.58152401008196,-1.53404353371823,-1.4865630573545,-1.43908258099077,-1.39160210462704,-1.34412162826332,-1.29664115189959,-1.24916067553586,-1.20168019917213,-1.1541997228084,-1.10671924644467,-1.05923877008094,-1.01175829371721,-0.964277817353481,-0.916797340989752,-0.869316864626023,-0.821836388262294,-0.774355911898564,-0.726875435534835,-0.679394959171106,-0.631914482807377,-0.584434006443648,-0.536953530079918,-0.489473053716189,-0.44199257735246,-0.39451210098873,-0.347031624625001,-0.299551148261272,-0.252070671897543,-0.204590195533814,-0.157109719170085,-0.109629242806355,-0.0621487664426259,-0.0146682900788973,0.0328121862848323,0.0802926626485614,0.12777313901229,0.17525361537602,0.222734091739749,0.270214568103478,0.317695044467208,0.365175520830937,0.412655997194666,0.460136473558395],[-1.92751449451558,-1.88003401815185,-1.83255354178813,-1.7850730654244,-1.73759258906067,-1.69011211269694,-1.64263163633321,-1.59515115996948,-1.54767068360575,-1.50019020724202,-1.45270973087829,-1.40522925451456,-1.35774877815083,-1.3102683017871,-1.26278782542338,-1.21530734905965,-1.16782687269592,-1.12034639633219,-1.07286591996846,-1.02538544360473,-0.977904967241,-0.930424490877271,-0.882944014513542,-0.835463538149812,-0.787983061786083,-0.740502585422354,-0.693022109058625,-0.645541632694896,-0.598061156331166,-0.550580679967437,-0.503100203603708,-0.455619727239978,-0.408139250876249,-0.36065877451252,-0.313178298148791,-0.265697821785062,-0.218217345421333,-0.170736869057603,-0.123256392693874,-0.0757759163301452,-0.0282954399664157,0.0191850363973134,0.0666655127610425,0.114145989124772,0.161626465488501,0.20910694185223,0.25658741821596,0.304067894579689,0.351548370943418,0.399028847307147],[-1.98862212076683,-1.9411416444031,-1.89366116803937,-1.84618069167564,-1.79870021531191,-1.75121973894819,-1.70373926258446,-1.65625878622073,-1.608778309857,-1.56129783349327,-1.51381735712954,-1.46633688076581,-1.41885640440208,-1.37137592803835,-1.32389545167462,-1.27641497531089,-1.22893449894716,-1.18145402258344,-1.13397354621971,-1.08649306985598,-1.03901259349225,-0.991532117128518,-0.944051640764789,-0.89657116440106,-0.849090688037331,-0.801610211673601,-0.754129735309872,-0.706649258946143,-0.659168782582414,-0.611688306218685,-0.564207829854956,-0.516727353491226,-0.469246877127497,-0.421766400763768,-0.374285924400039,-0.32680544803631,-0.279324971672581,-0.231844495308851,-0.184364018945121,-0.136883542581393,-0.0894030662176633,-0.0419225898539342,0.00555788650979494,0.053038362873524,0.100518839237253,0.147999315600982,0.195479791964712,0.242960268328441,0.29044074469217,0.3379212210559],[-2.04972974701808,-2.00224927065435,-1.95476879429062,-1.90728831792689,-1.85980784156316,-1.81232736519943,-1.7648468888357,-1.71736641247198,-1.66988593610825,-1.62240545974452,-1.57492498338079,-1.52744450701706,-1.47996403065333,-1.4324835542896,-1.38500307792587,-1.33752260156214,-1.29004212519841,-1.24256164883468,-1.19508117247095,-1.14760069610722,-1.1001202197435,-1.05263974337977,-1.00515926701604,-0.957678790652308,-0.910198314288579,-0.862717837924849,-0.81523736156112,-0.767756885197391,-0.720276408833662,-0.672795932469933,-0.625315456106204,-0.577834979742474,-0.530354503378745,-0.482874027015016,-0.435393550651287,-0.387913074287558,-0.340432597923829,-0.292952121560099,-0.245471645196369,-0.197991168832641,-0.150510692468911,-0.103030216105182,-0.0555497397414531,-0.00806926337772396,0.0394112129860051,0.0868916893497342,0.134372165713464,0.181852642077193,0.229333118440922,0.276813594804652],[-2.11083737326933,-2.0633568969056,-2.01587642054187,-1.96839594417814,-1.92091546781441,-1.87343499145068,-1.82595451508695,-1.77847403872322,-1.73099356235949,-1.68351308599576,-1.63603260963204,-1.58855213326831,-1.54107165690458,-1.49359118054085,-1.44611070417712,-1.39863022781339,-1.35114975144966,-1.30366927508593,-1.2561887987222,-1.20870832235847,-1.16122784599474,-1.11374736963101,-1.06626689326728,-1.01878641690356,-0.971305940539826,-0.923825464176097,-0.876344987812368,-0.828864511448639,-0.781384035084909,-0.73390355872118,-0.686423082357451,-0.638942605993722,-0.591462129629992,-0.543981653266263,-0.496501176902534,-0.449020700538805,-0.401540224175076,-0.354059747811347,-0.306579271447617,-0.259098795083888,-0.211618318720159,-0.16413784235643,-0.116657365992701,-0.0691768896289715,-0.0216964132652424,0.0257840630984867,0.0732645394622167,0.120745015825946,0.168225492189675,0.215705968553404]],"opacity":0.7,"type":"surface","frame":null},{"x":[0.372198376338929,0.0438248154241592,0.709684018278494,0.657690396532416,0.249855723232031,0.30005483306013,0.584866625955328,0.333467143354937,0.622011963743716,0.54582855431363,0.879795730113983,0.706874740775675,0.731972594512627,0.931634427979589,0.455120594473556,0.590319729177281,0.820436094887555,0.224118480458856,0.411666829371825,0.0386105608195066,0.700711545301601,0.956837461562827,0.213352001970634,0.661061500199139,0.923318882007152,0.795719761401415,0.0712125543504953,0.389407767681405,0.406451216200367,0.659355078125373,0.423347146715969,0.320984446210787,0.197730733314529,0.163170094368979,0.523311075055972,0.913478652015328,0.206772719044238,0.814283016137779,0.0201671982649714,0.924804413458332,0.434961745981127,0.44205468473956,0.760689455317333,0.332961300387979,0.39435715181753,0.233294282807037,0.0716076579410583,0.913383485749364,0.771693573100492,0.107536639785394],"y":[0.0792122506536543,0.433889447478577,0.679774246877059,0.73435624060221,0.452510874019936,0.783785715699196,0.679835536982864,0.518703651148826,0.690805754158646,0.588275650283322,0.81458966806531,0.810044945916161,0.609935902291909,0.993409643415362,0.84324054280296,0.715503402985632,0.0190811885986477,0.30508025130257,0.882947984384373,0.941346816252917,0.23441800987348,0.936665828339756,0.566701976815239,0.842790403170511,0.821301179705188,0.279972854303196,0.0473011373542249,0.224940627580509,0.673092647222802,0.958930858410895,0.685259971302003,0.775802984833717,0.775838489178568,0.982794799143448,0.010188644984737,0.952585851075128,0.322935862233862,0.428005344932899,0.134496691403911,0.0183283127844334,0.656499502481893,0.914733336074278,0.715299851726741,0.182951447088271,0.240068171871826,0.836449080146849,0.385873456252739,0.232573804445565,0.0689206402748823,0.0622245285194367],"z":[0.356504719455528,-0.488489873403877,0.957946298786982,-1.28459057531883,0.891236540569034,-1.80243417790028,0.295607511587771,1.24063245375862,1.34532912924721,-0.101033074073126,0.0560203481925625,-1.42755839985382,-0.00722007193211782,-0.00450256513446001,-0.196876108323204,0.42096454061334,1.89583029789715,0.681898695673006,-0.883160042891964,-1.82164269204212,3.20806649910154,1.72361444604631,0.879756240480349,-0.283851804561905,-1.43620027589923,0.714076377157176,1.30301394228205,-0.173952514625109,-0.0680364616827005,-0.609066542742995,1.64306195445616,0.426235207458244,-1.44342932267249,-2.16592531250965,0.287128931522782,0.439949289756564,0.450124973558669,2.69259578302961,1.36094103561758,4.34717305322596,1.22589481623881,-0.894355731236911,0.0144659577966847,0.396902837202829,1.35052472138708,-1.83328433839026,-0.459309603604776,3.49403872754073,2.83407956367123,0.214003218171155],"opacity":0.7,"type":"scatter3d","mode":"markers","marker":{"color":"black","opacity":0.7,"symbol":1,"size":5,"line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>

]


---

# The general MLR model

.font125[

* Suppose we have a total of `\(k = p - 1\)` predictors `\(X_1, X_2, \dots, X_{p-1}\)`. The MLR model is `$$Y_i = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} + \dots \beta_{p-1} X_{p-1} + \epsilon_i, \quad i = 1, 2, \dots, n$$` where we assume `\(\epsilon_i \stackrel{iid}{\sim} \left(0, \sigma^2\right)\)`

]

--

.font125[

* In short, we have a mean response of the form `$$E\left(Y_i\right) = \beta_0 + \sum_{j = 1}^{p-1}\beta_j X_{ij} = \underbrace{\sum_{j = 0}^{p-1}\beta_j X_{ij}}_{\text{dot product}}, \quad \text{where } X_{i0} \equiv 1$$`

]


---

# The general MLR model

.font125[

The MLR model with normal errors `$$Y_i = \beta_0 + \sum_{j = 1}^{p-1}\beta_j X_{ij} + \epsilon_i, \quad i = 1, 2, \dots, n$$`

]

.font125[

* `\(\beta_0, \beta_1, \dots, \beta_{p-1}\)` are (unknown) regression coefficients (AKA weights or parameters)

* `\(X_{i1}, X_{i2}, \dots, X_{i,p-1}\)` are known **constants** (i.e., assumed fixed by design)

* `\(\epsilon_i \stackrel{iid}{\sim} N\left(0, \sigma^2\right)\)`

]


---
class: clear, center, middle

&lt;img src="images/mlr-data.png" width="100%" style="display: block; margin: auto;" /&gt;


---

# Categorical predictors

&lt;img src="images/dummy-encoding.png" width="100%" style="display: block; margin: auto;" /&gt;

.center.font150[

More on categorical predictors in [Lecture 05](https://bgreenwell.github.io/uc-bana7052/slides/lecture-05#1)

]


---

# Estimating the coefficients

.font150[

The regression coefficients can be estimated using least squares by minimizing `$$Q = \sum_{i = 1}^n\left(Y_i - \beta_0 - \beta_1 X_{i1} - \dots - \beta_{p-1} X_{i, p-1}\right)^2$$`

]

.center.font150.content-box-yellow[

Equating the partial derivatives to zero amounts to solving a system of `\(n\)` (linear) equations in `\(p\)` unknowns

]


---
class: clear

background-image: url(images/matrix-approach.png)


---

# Matrix form of the MLR model

.font115[

 In matrix form, the MLR can be expressed as `\(\boldsymbol{Y} = \boldsymbol{X}\boldsymbol{\beta} + \boldsymbol{\epsilon}\)`
 
 
 * `\(\boldsymbol{Y} = \left(Y_1, Y_2, \dots, Y_n\right)^\top\)` is an `\(n \times 1\)` vector of responses
 
 * `\(\boldsymbol{\beta} = \left(\beta_0, \beta_1, \dots, \beta_{p-1}\right)^\top\)` is an `\(p \times 1\)` vector of coefficients
 
 * `\(\boldsymbol{\epsilon} = \left(\epsilon_1, \epsilon_2, \dots, \epsilon_n\right)^\top \sim N\left(\boldsymbol{0}_n, \sigma^2 \boldsymbol{I}_n\right)\)` .font125[.red[👈 What does this mean? 🤔]]
 
 * `\(\boldsymbol{X} = \begin{bmatrix} 1 &amp; X_{11} &amp; X_{12} &amp; \cdots &amp; X_{1,p-1} \\ 1 &amp; X_{21} &amp; X_{22} &amp; \cdots &amp; X_{2,p-1} \\ \vdots &amp; \vdots &amp; &amp; \vdots \\ 1 &amp; X_{n1} &amp; X_{n2} &amp; \cdots &amp; X_{n,p-1} \\ \end{bmatrix}\)` is an `\(n \times p\)` **model matrix**

]


---

# Least squares estimation

.font150[

We want to find the value of `\(\boldsymbol{\beta}\)` that minimizes `$$\begin{align} \boldsymbol{Q} &amp;= \left(\boldsymbol{Y} - \boldsymbol{X}\boldsymbol{\beta}\right)^\top\left(\boldsymbol{Y} - \boldsymbol{X}\boldsymbol{\beta}\right) \\ &amp;= \boldsymbol{Y}^\top\boldsymbol{Y} - 2\boldsymbol{\beta}^\top\boldsymbol{X}^\top\boldsymbol{Y} + \boldsymbol{\beta}^\top\boldsymbol{X}^\top\boldsymbol{X}\boldsymbol{\beta} \end{align}$$`

Differentiating `\(\boldsymbol{Q}\)` w.r.t. `\(\boldsymbol{\beta}\)` and equating to zero yields `$$\frac{\partial \boldsymbol{Q}}{\partial \boldsymbol{\beta}} = -2\boldsymbol{X}^\top\boldsymbol{Y} + 2\boldsymbol{X}^\top\boldsymbol{X}\boldsymbol{\beta} = \boldsymbol{0}_p$$`

* The .bold.red[normal equations]: `\(\boldsymbol{X}^\top\boldsymbol{X}\boldsymbol{\beta} = \boldsymbol{X}^\top\boldsymbol{Y}\)`

]


---

# Least squares estimation

.font200[

&lt;br&gt;

Solving the normal equations for `\(\boldsymbol{\beta}\)` leads to the least squares estimate:

`$$\widehat{\boldsymbol{\beta}} = \left(\boldsymbol{X}^\top\boldsymbol{X}\right)^{-1}\boldsymbol{X}^\top\boldsymbol{Y}$$`

]


---
class: clear, middle, center

.font200[

`\(\boldsymbol{X}\)` has to be .content-box-red[full rank] in order for `\(\left(\boldsymbol{X}^\top\boldsymbol{X}\right)\)` to be invertible!

]

--

.center[.font125[.content-box-yellow[

This is one reason why we dummy encode categorical variables

]]]

---

# The fitted model

.font150[

* Fitted values: `\(\widehat{\boldsymbol{Y}} = \boldsymbol{X}\widehat{\boldsymbol{\beta}} = \boldsymbol{X}\left(\boldsymbol{X}^\top\boldsymbol{X}\right)^{-1}\boldsymbol{X}^\top\boldsymbol{Y} = \boldsymbol{H}\boldsymbol{Y}\)`

]

.font150[

* Residuals: `\(\boldsymbol{\epsilon} = \boldsymbol{Y} - \widehat{\boldsymbol{Y}} = \boldsymbol{Y} - \boldsymbol{X}\widehat{\boldsymbol{\beta}} = \left(\boldsymbol{I} - \boldsymbol{H}\right)\boldsymbol{Y}\)`

]

.font150.content-box-yellow[

`\(\boldsymbol{H}\)` is both *symmetric* (i.e., `\(\boldsymbol{H}^\top = \boldsymbol{H}\)`) and *idempotent* (i.e., `\(\boldsymbol{H} = \boldsymbol{H}\boldsymbol{H}\)`) and is referred to as the *hat matrix* (the diagonal entries of `\(H\)` are important in .bold.red[detecting "influential" observations])

]


---

# Properties of `\(\widehat{\boldsymbol{\beta}}\)`

.font150[

Assuming `\(\boldsymbol{\epsilon} \sim N\left(\boldsymbol{0}_n, \sigma^2\boldsymbol{I}_n\right)\)`, what are some properties of the LS estimate of `\(\boldsymbol{\beta}\)`?

]

.font150[

* Unbiased: `\(E\left(\widehat{\boldsymbol{\beta}}\right) = \boldsymbol{\beta}\)`

* Variance-covariance matrix: `\(Var\left(\widehat{\boldsymbol{\beta}}\right) = \sigma^2 \left(\boldsymbol{X}^\top\boldsymbol{X}\right)^{-1}\)`

* Sampling distribution: `\(\widehat{\boldsymbol{\beta}} \sim N\left(\boldsymbol{\beta}, \sigma^2 \left(\boldsymbol{X}^\top\boldsymbol{X}\right)^{-1}\right)\)`

]


---

# Delivery data example <span>&lt;i class="fas  fa-truck faa-passing animated faa-slow "&gt;&lt;/i&gt;</span>

.font110[

A soft drink bottler is analyzing vending machine service routes in their distribution system. They are interested in predicting the amount of time required by the route driver to service the vending machines in an outlet. This service activity includes stocking the machine with beverage products and minor maintenance or housekeeping. The industrial engineer responsible for the study has suggested that the two most important variables affecting delivery time in minutes ( `\(Y\)` ) are the number of cases of product stocked ( `\(X_1\)` ) and the distance walked by the route driver in feet ( `\(X_2\)` ). The engineer has collected `\(n = 25\)` observations on delivery time which are stored in the file [delivery.csv](https://bgreenwell.github.io/uc-bana7052/data/delivery.csv). We'll use these data to fit the MLR model `$$Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \epsilon$$`.

]


---

# Delivery data example <span>&lt;i class="fas  fa-truck faa-passing animated faa-slow "&gt;&lt;/i&gt;</span>

.font125[


```r
# Load the delivery data
url &lt;- "https://bgreenwell.github.io/uc-bana7052/data/delivery.csv"
delivery &lt;- read.csv(url)
head(delivery, n = 5)  # print first 5 observations
```

```
##   Index DeliveryTime NumberofCases Distance
## 1     1        16.68             7      560
## 2     2        11.50             3      220
## 3     3        12.03             3      340
## 4     4        14.88             4       80
## 5     5        13.75             6      150
```

]


---
class: clear, middle

.pull-left[

.code125[


```r
GGally::ggpairs(
* data = delivery[, -1]
)  
```

]

]

.pull-right[

&lt;img src="lecture-03_files/figure-html/delivery-ggpairs-02-1.svg" width="100%" style="display: block; margin: auto;" /&gt;

]


---
class: clear, middle

.pull-left[

.code125[


```r
lattice::splom(
* x = delivery[, -1],
  type = c("p", "smooth"), 
  pch = 19, 
  col = "dodgerblue2", 
  lty = "dotted", 
  alpha = 0.6
)
```

]

]

.pull-right[

&lt;img src="lecture-03_files/figure-html/delivery-splom-02-1.svg" width="100%" style="display: block; margin: auto;" /&gt;

]


---

# Delivery data example <span>&lt;i class="fas  fa-truck faa-passing animated faa-slow "&gt;&lt;/i&gt;</span>

.code125[


```r
# Fit a multile linear regression model
delivery_fit &lt;- lm(DeliveryTime ~ NumberofCases + 
                     Distance, data = delivery)

# Extract estimated coefficients
coef(delivery_fit)  
```

```
##   (Intercept) NumberofCases      Distance 
##    2.34123115    1.61590721    0.01438483
```

]


---

# Delivery data example <span>&lt;i class="fas  fa-truck faa-passing animated faa-slow "&gt;&lt;/i&gt;</span>

.code125[


```r
# Fit a multile linear regression model
delivery_fit &lt;- lm(DeliveryTime ~ ., 
                   data = delivery)

# Extract estimated coefficients
coef(delivery_fit)  
```

```
##   (Intercept)         Index NumberofCases      Distance 
##    4.31840829   -0.17446680    1.71339729    0.01300894
```

]

.font150.center[

`y ~ ., data = df` is shorthand for regress `y` on every other column in `df`

]


---

# Delivery data example <span>&lt;i class="fas  fa-truck faa-passing animated faa-slow "&gt;&lt;/i&gt;</span>

.code125[


```r
# Fit a multile linear regression model
*delivery &lt;- subset(delivery, select = -Index)
(delivery_fit &lt;- lm(DeliveryTime ~ ., data = delivery))
```

```
## 
## Call:
## lm(formula = DeliveryTime ~ ., data = delivery)
## 
## Coefficients:
##   (Intercept)  NumberofCases       Distance  
##       2.34123        1.61591        0.01438
```

]


---

# How do we interpret `\(\widehat{\beta}_i\)`?

.code125[


```r
*round(coef(delivery_fit), digits = 3)
```

```
##   (Intercept) NumberofCases      Distance 
##         2.341         1.616         0.014
```

]

--

.font150[

* .bold[.red[All else held constant]], for every one additional case, the mean delivery time increases by 1.616 minutes

* .bold[.red[All else held constant]], for every one-unit increase in distance, the mean delivery time increases by 0.014 minutes

]


---
class: clear, middle, center

.font150.center.content-box-red[

In general, `\(\widehat{\beta}_j\)` is the estimated increase in the mean response per one-unit increase in `\(X_j\)` (**all else held constant**)

]


---

# Delivery data example <span>&lt;i class="fas  fa-truck faa-passing animated faa-slow "&gt;&lt;/i&gt;</span>

.scrollable[

.font150[


```r
xnames &lt;- c("NumberofCases", "Distance")
X &lt;- data.matrix(delivery[, xnames])
head(X)
```

```
##   NumberofCases Distance
## 1             7      560
## 2             3      220
## 3             3      340
## 4             4       80
## 5             6      150
## 6             7      330
```

```r
Y &lt;- delivery$DeliveryTime
*solve(t(X) %*% X) %*% t(X) %*% Y
```

```
##                     [,1]
## NumberofCases 1.70790180
## Distance      0.01611513
```

]

]


---

# Delivery data example <span>&lt;i class="fas  fa-truck faa-passing animated faa-slow "&gt;&lt;/i&gt;</span>

.scrollable[

.font150[


```r
X &lt;- model.matrix(~ NumberofCases + Distance, 
                  data = delivery)
head(X)
```

```
##   (Intercept) NumberofCases Distance
## 1           1             7      560
## 2           1             3      220
## 3           1             3      340
## 4           1             4       80
## 5           1             6      150
## 6           1             7      330
```

```r
Y &lt;- delivery$DeliveryTime
*solve(t(X) %*% X) %*% t(X) %*% Y
```

```
##                     [,1]
## (Intercept)   2.34123115
## NumberofCases 1.61590721
## Distance      0.01438483
```

]

]


---

# Delivery data example <span>&lt;i class="fas  fa-truck faa-passing animated faa-slow "&gt;&lt;/i&gt;</span>

.font125[


```r
# Extract fitted values and residuals
.fitted &lt;- fitted(delivery_fit)
.resids &lt;- residuals(delivery_fit)
head(cbind(delivery, .fitted, .resids))
```

```
##   DeliveryTime NumberofCases Distance   .fitted    .resids
## 1        16.68             7      560 21.708084 -5.0280843
## 2        11.50             3      220 10.353615  1.1463854
## 3        12.03             3      340 12.079794 -0.0497937
## 4        14.88             4       80  9.955646  4.9243539
## 5        13.75             6      150 14.194398 -0.4443983
## 6        18.11             7      330 18.399574 -0.2895743
```

]

--

.font125.center[

What would `.fitted + .resids` produce?

]


---

# Your turn

.font125[

Harrison and Rubinfeld (1978) were among the first to analyze the well-known Boston housing data. One of their goals was to find a [housing value equation](https://bgreenwell.github.io/pdp/articles/pdp.html) using data on median home values from `\(n =506\)` census tracts in the suburbs of Boston from the 1970 census; see `?pdp::boston` for a description of each variable. Fit an MLR model using `cmed` as the response and `lstat` and `rm` as the predictors and interpret the coefficients. Be sure to construct a scatterplot matrix as well. What do you predict the median value to be for a census tract with `lstat` = 20 and `rm` = 6? **Hint:** to load the data, use the following code chunk:


```r
data(boston, package = "pdp")
```

]


---
class: clear, middle


```r
pairs(pdp::boston[, c("cmedv", "lstat", "rm")], pch = 19,
      col = "black")
```

&lt;img src="lecture-03_files/figure-html/boston-spm-01-1.svg" width="100%" style="display: block; margin: auto;" /&gt;

---
class: clear, middle


```r
pairs(pdp::boston[, c("cmedv", "lstat", "rm")], pch = 19, 
*     col = adjustcolor("black", alpha.f = 0.2))
```

&lt;img src="lecture-03_files/figure-html/boston-spm-02-1.svg" width="100%" style="display: block; margin: auto;" /&gt;


---

# Solution

.code125[


```r
coef(boston_fit &lt;- lm(cmedv ~ lstat + rm, 
                      data = pdp::boston))
```

```
## (Intercept)       lstat          rm 
##  -1.1234337  -0.6466673   5.0654673
```

]

--

.font150[

All else held constant, within a census tract, we estimate that the average median home value will .red.bold[decrease] by $646.67 for every 1% increase in `lstat`

]

---

# Solution

.scrollable[

.code125[


```r
predict(
  object = boston_fit, 
* newdata = data.frame(lstat = 20, rm = 6),
* se.fit = TRUE,
* interval = "confidence"
)
```

```
## $fit
##        fit      lwr     upr
## 1 16.33602 15.63264 17.0394
## 
## $se.fit
## [1] 0.358011
## 
## $df
## [1] 503
## 
## $residual.scale
## [1] 5.501251
```

]

]


---

# Inferences in the MLR model

.font160[

Once we fit an MLR model, we might ask ourselves:

* How well does the model fit the data? (Lectures [04](https://bgreenwell.github.io/uc-bana7052/slides/lecture-04#1)/[06](https://bgreenwell.github.io/uc-bana7052/slides/lecture-06#1))
    
* Which predictors seem "important"?

]

--

.font125.center.content-box-green[

Statistical inference in the MLR model is not that different from inference in SLR (only a slight change in the formulas)

]


---

# Significance of the regression

.font150.center.content-box-purple[

Is there a (statistically significant) linear relationship between the response and **ANY** of the features?

]

--

.font150[

Hypotheses:

`\(\quad H_0: \beta_1 = \beta_2 = \dots = \beta_k = 0\)`

`\(\quad H_1: \beta_j \ne 0\)` for at least one `\(j\)`

]


---

# The general linear test

.font150[

.bold[Full model]: `\(Y_i = \beta_0 + \beta_1 X_{i1} + \dots + \beta_k X_{i, p-1} + \epsilon_i\)`

.bold[Reduced model]: `\(Y_i = \beta_0 + \epsilon_i\)` (if `\(H_0\)` were true)

]

--

.font150[


* `\(F_{obs} = \frac{SSE(R) - SSE(F)}{df_R - df_F} \div \frac{SSE(F)}{df_F} = \frac{MSR}{MSE}\)`
    
* Reject `\(H_0\)` whenever `\(F_{obs} &gt; F_{1 - \alpha, df_R - df_F, df_F}\)`
    
    - Here `\(df_R - df_F = p - 1\)` and `\(df_F = n - p\)`
    
]


---
class: clear


```r
summary(delivery_fit)
```

```
## 
## Call:
## lm(formula = DeliveryTime ~ ., data = delivery)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.7880 -0.6629  0.4364  1.1566  7.4197 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   2.341231   1.096730   2.135 0.044170 *  
*## NumberofCases 1.615907   0.170735   9.464 3.25e-09 ***
*## Distance      0.014385   0.003613   3.981 0.000631 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 3.259 on 22 degrees of freedom
## Multiple R-squared:  0.9596,	Adjusted R-squared:  0.9559 
*## F-statistic: 261.2 on 2 and 22 DF,  p-value: 4.687e-16
```


---

# Delivery data example <span>&lt;i class="fas  fa-truck faa-passing animated faa-slow "&gt;&lt;/i&gt;</span>

.font125[


```r
# Manually construct F-test
delivery_fit_reduced &lt;- lm(DeliveryTime ~ 1, data = delivery)
anova(delivery_fit_reduced, delivery_fit)
```

```
## Analysis of Variance Table
## 
## Model 1: DeliveryTime ~ 1
## Model 2: DeliveryTime ~ NumberofCases + Distance
##   Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
## 1     24 5784.5                                  
*## 2     22  233.7  2    5550.8 261.24 4.687e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

]


---

# Coefficient of determination

.pull-left[

.font200[R-squared]

.font125[

* `\(R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST}\)`

* `\(R^2\)` will always increase as more terms are added to the model!

.center[<span style=" display: -moz-inline-stack; display: inline-block; transform: rotate(0deg);">&lt;img src="https://emojis.slackmojis.com/emojis/images/1471045885/967/wtf.gif?1471045885" style="height:6em; width:auto; "/&gt;</span>]

]

]

--

.pull-right[

.font200[Adjusted R-squared]

.font125[

* `\(\begin{align} R_{adj}^2 &amp;= 1 - \frac{SSR / \left(n - p\right)}{SST / \left(n - 1\right)} \\ &amp;= 1 - \left(\frac{n - 1}{n - p}\right)\frac{SSR}{SST} \end{align}\)`
    
* Penalizes `\(R^2\)` if there are "too many" terms in the model

]

]

---
class: clear, middle


```r
summary(delivery_fit)
```

```
## 
## Call:
## lm(formula = DeliveryTime ~ ., data = delivery)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.7880 -0.6629  0.4364  1.1566  7.4197 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   2.341231   1.096730   2.135 0.044170 *  
## NumberofCases 1.615907   0.170735   9.464 3.25e-09 ***
## Distance      0.014385   0.003613   3.981 0.000631 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 3.259 on 22 degrees of freedom
*## Multiple R-squared:  0.9596,	Adjusted R-squared:  0.9559 
## F-statistic: 261.2 on 2 and 22 DF,  p-value: 4.687e-16
```


---

# Delivery data example <span>&lt;i class="fas  fa-truck faa-passing animated faa-slow "&gt;&lt;/i&gt;</span>

.scrollable[

.font125[


```r
# Simulate new columns at random
set.seed(101)  # for reproducibility
delivery2 &lt;- delivery
delivery2$X3 &lt;- rnorm(nrow(delivery))
delivery2$X4 &lt;- rnorm(nrow(delivery))
delivery2$X5 &lt;- rnorm(nrow(delivery))

# Update the fitted mode
delivery2_fit &lt;- lm(DeliveryTime ~ ., data = delivery2)

# Print model summary
summary(delivery2_fit)
```

```
## 
## Call:
## lm(formula = DeliveryTime ~ ., data = delivery2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.7050 -2.1064  0.0926  2.1312  5.3286 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    2.660614   1.166109   2.282  0.03422 *  
## NumberofCases  1.545039   0.180419   8.564 6.01e-08 ***
## Distance       0.015325   0.003539   4.331  0.00036 ***
*## X3             1.722868   0.786424   2.191  0.04114 *  
*## X4            -0.527332   0.687769  -0.767  0.45267    
*## X5            -0.126148   0.782961  -0.161  0.87370    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 3.113 on 19 degrees of freedom
*## Multiple R-squared:  0.9682,	Adjusted R-squared:  0.9598 
## F-statistic: 115.6 on 5 and 19 DF,  p-value: 1.519e-13
```

]

]


---

# Your turn

.font150[

Fit an MLR to the Boston housing data using the predictors `lstat`, `rm`, and `lon`. Is the regression significant? Use the general *F*-test to determine whether the model with only the predictors `lstat` and `rm` is adequate.

]


---

# Solution


```r
# General F-test
data(boston, package = "pdp")  # Load the data
fit1 &lt;- lm(cmedv ~ lstat + rm + lon, data = boston)  # full model
fit2 &lt;- lm(cmedv ~ lstat + rm, data = boston)  # reduced model
*anova(fit2, fit1)  # reduced model goes first
```

```
## Analysis of Variance Table
## 
## Model 1: cmedv ~ lstat + rm
## Model 2: cmedv ~ lstat + rm + lon
##   Res.Df   RSS Df Sum of Sq      F    Pr(&gt;F)    
## 1    503 15223                                  
## 2    502 14510  1    713.01 24.669 9.349e-07 ***
## ---
*## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```


---

# Inference for `\(\beta_j\)`

.font150[

Hypothesis test for a **single coefficient** (this is called a *marginal test*):

`$$H_0: \beta_j = 0 \quad vs. \quad H_1: \beta_j \ne 0$$`

* Test statistic: `\(t_{obs} = \widehat{\beta}_j / \widehat{SE}\left(\widehat{\beta}_j\right)\)`

* Reject `\(H_0\)` whenever `\(\left|t_{obs}\right| &gt; t_{1 - \alpha/2, n - p}\)`

* `\(\left(1 - \alpha\right)100\)`% CI for `\(\beta_j\)`: `\(\widehat{\beta}_j \pm t_{1 - \alpha/2, n - p} \widehat{SE}\left(\widehat{\beta}_j\right)\)`

]


---

# Delivery data example <span>&lt;i class="fas  fa-truck faa-passing animated faa-slow "&gt;&lt;/i&gt;</span>

.scrollable[

.font125[


```r
# Print summary of the model
*summary(delivery_fit)  # SEs and marginal tests
```

```
## 
## Call:
## lm(formula = DeliveryTime ~ ., data = delivery)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.7880 -0.6629  0.4364  1.1566  7.4197 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   2.341231   1.096730   2.135 0.044170 *  
## NumberofCases 1.615907   0.170735   9.464 3.25e-09 ***
## Distance      0.014385   0.003613   3.981 0.000631 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 3.259 on 22 degrees of freedom
## Multiple R-squared:  0.9596,	Adjusted R-squared:  0.9559 
## F-statistic: 261.2 on 2 and 22 DF,  p-value: 4.687e-16
```

```r
# Construct 95% CIs for the coefficients
confint(delivery_fit, level = 0.95)
```

```
##                     2.5 %     97.5 %
## (Intercept)   0.066751987 4.61571030
## NumberofCases 1.261824662 1.96998976
## Distance      0.006891745 0.02187791
```

]

]


---
class: clear, center, middle

.font200[

[Polynomial regression](https://github.com/bgreenwell/uc-bana7052/blob/master/code/hardwood.R)

]


---

# Polynomial regression

.font130[

* Just a special case of the MLR model

* A second order model in a single predictor `$$Y = \beta_0 + \beta_1 X + \beta_2 X^2 + \epsilon$$`

* A *k*-th order model in a single predictor `$$Y = \beta_0 + \sum_{j=1}^k\beta_j X^j + \epsilon$$` 

    - Typically `\(k \le 3\)`

]


---

# Some cautions ⚠️

.pull-left[

* Keep the order of the model as low as possible

    - This is especially true if you are using the model as a predictor ([*over fitting*](https://bgreenwell.github.io/intro-ml-r/intro-ml-r.html#14))

    - Use the simplest model possible to explain the data, but no simpler (*parsimony*)

    - An `\(n - 1\)` order model can perfectly fit a data set with `\(n\)` observations (Why is this bad 🤔)

]

.pull-right[

* Two model-building strategies:

    1. Fit the lowest order polynomial possible and build up (forward selection)
    
    2. Fit the highest order polynomial of interest, and remove terms one at a time (backward elimination)
    
    - These two procedures may not result in the same final model

* Increasing the order can result in an ill-conditioned `\(\boldsymbol{X}^\top\boldsymbol{X}\)` and *multicollinearity* 🤮

]


---
class: clear, center, middle

.font140[

Later in the course, if time permits, we'll cover [*multivariate adaptive regression splines*](https://koalaverse.github.io/AnalyticsSummit18/04-MARS.html#1) (MARS), an automatic multiple linear regression procedure

]

&lt;img src="lecture-03_files/figure-html/hell-yeah-1.svg" width="40%" style="display: block; margin: auto;" /&gt;


---
class: clear, middle, center

&lt;img src="lecture-03_files/figure-html/quittin-time-1.svg" width="60%" style="display: block; margin: auto;" /&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_HTMLorMML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
